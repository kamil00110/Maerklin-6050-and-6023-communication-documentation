<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>13cm Iframe Drag</title>

<style>
body {
  font-family: sans-serif;
  margin: 0;
  padding: 1cm;
}

#toolbar {
  margin-bottom: 1cm;
}

#addBtn {
  font-size: 18px;
  padding: 4px 10px;
  cursor: pointer;
}

#grid {
  position: relative;
  width: 100%;
  min-height: 100vh;
  border: 1px solid #ccc;
}

.iframe-wrapper {
  position: absolute;
  width: 13cm;
  height: 13cm;
  border: 2px solid #888;
  display: flex;
  flex-direction: column;
  background: #fff;
  user-select: none;
}

.drag-handle {
  height: 1cm;
  background: #ddd;
  cursor: grab;
  text-align: center;
  line-height: 1cm;
  font-weight: bold;
}

iframe {
  flex: 1;
  width: 100%;
  border: none;
}
</style>
</head>

<body>

<div id="toolbar">
  <button id="addBtn">＋ Add</button>
</div>

<div id="grid"></div>

<script>
const grid = document.getElementById("grid");
const addBtn = document.getElementById("addBtn");
let zIndexCounter = 1;

function createIframe(x = 20, y = 20) {
  const wrapper = document.createElement("div");
  wrapper.className = "iframe-wrapper";
  wrapper.style.left = x + "px";
  wrapper.style.top = y + "px";
  wrapper.style.zIndex = zIndexCounter++;

  const handle = document.createElement("div");
  handle.className = "drag-handle";
  handle.textContent = "⇅ Drag";

  const iframe = document.createElement("iframe");
  iframe.src = "unit.html"; // your HTML

  wrapper.appendChild(handle);
  wrapper.appendChild(iframe);
  grid.appendChild(wrapper);

  makeDraggable(wrapper, handle);
}

// Smooth dragging
function makeDraggable(wrapper, handle) {
  let offsetX = 0;
  let offsetY = 0;

  handle.addEventListener("pointerdown", (e) => {
    offsetX = e.clientX - wrapper.offsetLeft;
    offsetY = e.clientY - wrapper.offsetTop;
    wrapper.style.zIndex = zIndexCounter++;
    wrapper.setPointerCapture(e.pointerId);
  });

  handle.addEventListener("pointermove", (e) => {
    if (e.pressure === 0) return; // no drag if not pressed
    wrapper.style.left = (e.clientX - offsetX) + "px";
    wrapper.style.top = (e.clientY - offsetY) + "px";
  });

  handle.addEventListener("pointerup", (e) => {
    wrapper.releasePointerCapture(e.pointerId);
  });
}

// Add new iframe button
addBtn.addEventListener("click", () => {
  createIframe(
    20 + Math.random() * (window.innerWidth - 250),
    20 + Math.random() * (window.innerHeight - 250)
  );
});

// Start with 3 iframes
for (let i = 0; i < 3; i++) {
  createIframe(20 + i * 14 * 37.8, 20); // approximate row alignment
}
</script>

</body>
</html>
