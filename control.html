<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>12cm Iframe Grid</title>

<style>
  body {
    font-family: sans-serif;
  }

  #toolbar {
    margin-bottom: 1cm;
  }

  #addBtn {
    font-size: 18px;
    padding: 4px 10px;
    cursor: pointer;
  }

  #grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, 12cm);
    gap: 0.5cm;
  }

  .iframe-wrapper {
    width: 12cm;
    height: 12cm;
    border: 2px solid #888;
    background: white;
    display: flex;
    flex-direction: column;
    user-select: none;
  }

  .drag-handle {
    height: 0.8cm;
    background: #ddd;
    cursor: grab;
    text-align: center;
    line-height: 0.8cm;
    font-weight: bold;
  }

  iframe {
    flex: 1;
    width: 100%;
    border: none;
  }

  .dragging {
    opacity: 0.6;
  }
</style>
</head>

<body>

<div id="toolbar">
  <button id="addBtn">＋ Add</button>
</div>

<div id="grid"></div>

<script>
const grid = document.getElementById("grid");
const addBtn = document.getElementById("addBtn");

let dragItem = null;

function createIframe(order) {
  const wrapper = document.createElement("div");
  wrapper.className = "iframe-wrapper";
  wrapper.style.order = order;

  const handle = document.createElement("div");
  handle.className = "drag-handle";
  handle.textContent = "⇅ Drag";

  const iframe = document.createElement("iframe");
  iframe.src = "unit.html"; // Your HTML file

  wrapper.appendChild(handle);
  wrapper.appendChild(iframe);
  grid.appendChild(wrapper);

  makeDraggable(wrapper, handle);
}

function makeDraggable(wrapper, handle) {
  handle.addEventListener("pointerdown", (e) => {
    dragItem = wrapper;
    wrapper.classList.add("dragging");
    handle.setPointerCapture(e.pointerId);
  });

  handle.addEventListener("pointermove", (e) => {
    if (!dragItem) return;
    const el = document.elementFromPoint(e.clientX, e.clientY);
    const target = el?.closest(".iframe-wrapper");
    if (target && target !== dragItem && target.parentNode === grid) {
      const items = [...grid.children];
      const draggedIndex = items.indexOf(dragItem);
      const targetIndex = items.indexOf(target);
      if (draggedIndex < targetIndex) {
        grid.insertBefore(dragItem, target.nextSibling);
      } else {
        grid.insertBefore(dragItem, target);
      }
    }
  });

  handle.addEventListener("pointerup", (e) => {
    dragItem?.classList.remove("dragging");
    dragItem = null;
    handle.releasePointerCapture(e.pointerId);
  });
}

addBtn.addEventListener("click", () => {
  createIframe(grid.children.length);
});

// Start with 3 iframes
for (let i = 0; i < 3; i++) createIframe(i);
</script>

</body>
</html>
